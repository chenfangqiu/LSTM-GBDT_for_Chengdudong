# 一堆bug的LSTM和GBDT

#### 使用说明

1. 使用本实验已经训练好了的模型：直接运行main.py
2. 自行训练：
2.1. 运行train_lstm.py和train_gbdt.py，得到lstm_200.pt和gbr.pkl两个模型文件
2.2. 运行main.py

#### 介绍

预测理论与方法2021春季课程作业

#### LSTM部分
1、导入数据，利用dropna()方法去除空值，将类型转变为float32；
2、数据去量纲，归一化处理；
3、制作LSTM训练集：
    3.1、确定窗口大小。由于目标是预测一日数据，一日有73个十五分钟客流数据，故窗口大小设定为73；
    3.2、制作X和Y的数据集。进行4379次（所有数据数量减窗口大小再减1）循环，在第i次循环中：将数据集的第i到i+73个数据放于X矩阵的第i行中，并将数据集的第i+74个数据放于Y向量的第i位中；
    3.3、制作训练集的X和Y。去除X和Y中的最后一周数据；
    3.4、将训练数据转化为tensor，X转变为4307行1列73维的tensor，Y转变为4307行1列1维的tensor；
4、构建LSTM模型：
    4.1、输入维度（input_size）为73维、其他参数可以自行调整，本实验中使用hidden_size=4,output_size=1,num_layer=2，其余参数保持torch中的默认值；
    4.2、网络结构第一层设定为双层LSTM，第二层为全连接层；
    4.3、设定损失函数为MSE、优化器为Adam，学习率0.1；
5、模型训练，可以自选迭代次数，本实验中选择1000次；
6、预测并评价。

#### GBDT部分
1、与LSTM的1到3相同，但不转化为tensor，转化为array；
2、构建GBDT回归树模型，弱学习器数量为3000个（也可选择别的数量），学习率0.01，其余参数与scikit-learn默认值一致；
3、模型训练；
4、预测并评价。
